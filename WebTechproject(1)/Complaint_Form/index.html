<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><h1>Complaint Form<h1></title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
    <div class="container">
        <form action="submit_complaint.php" method="post" enctype="multipart/form-data">
            <h2 class="form-title">Complaint Form</h2>
            <label for="name"><b>Name:</b></label>
            <input type="text" id="name" name="name" required /><br />

            <label for="email"><b>Email:</b></label>
            <input type="email" id="email" name="email" pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$" title="Please enter a valid email address" required /><br />

            <label for="dob"><b>Date of Birth:</b></label>
            <input type="date" id="dob" name="dob" required /><br /> <!-- Date of Birth field -->

            <label for="age"><b>Age:</b></label>
            <input type="number" id="age" name="age" readonly /><br /> <!-- Age field (read-only) -->

            <label for="state"><b>State:</b></label>
            <select onchange="print_city('state', this.selectedIndex);" id="sts" name="state" class="form-control" required></select><br />

            <label for="city"><b>City:</b></label>
            <select id="state" name="city" class="form-control" required></select><br />

            <label for="pincode"><b>Pincode:</b></label>
            <input type="text" id="pincode" name="pincode" pattern="[0-9]{6}" title="Pincode must be 6 digits" required /><br />

            <label for="problem"><b>Problem Description:</b></label><br />
            <textarea id="problem" name="problem" rows="4" cols="50" required></textarea><br />

            <label for="image"><b>Upload Image:</b></label>
            <input type="file" id="image" name="image" accept="image/*" required /><br /> <!-- Restricting to image files -->

            <div class="submit-button">
                <input type="submit" value="Submit" />
            </div>
        </form>
    </div>
    <script src="cities.js"></script>
    <script language="javascript">
        print_state("sts");

        // Function to calculate age based on Date of Birth
        document.getElementById("dob").addEventListener("change", function() {
            var dob = new Date(this.value);
            var today = new Date();
            var age = today.getFullYear() - dob.getFullYear();
            var monthDiff = today.getMonth() - dob.getMonth();
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < dob.getDate())) {
                age--;
            }
            document.getElementById("age").value = age;
        });
    </script>
</body>
</html>
